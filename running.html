<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-227235287-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-227235287-1');
    </script>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>EXPAND - Ad-Hoc Parallel File System</title>

    <!-- Required stylesheets -->
    <link type="text/css" rel="stylesheet" href="external/bootstrap_vue/bootstrap.min.css"/>
    <link type="text/css" rel="stylesheet" href="external/bootstrap_vue/bootstrap-largegrid.min.css"/>
    <link type="text/css" rel="stylesheet" href="external/bootstrap_vue/bootstrap-vue.min.css"/>
    <link type="text/css" rel='stylesheet' href="external/fontawesome/css/all.css">
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Required scripts -->
    <script src="external/bootstrap_vue/polyfill.min.js"></script>
    <script src="external/bootstrap_vue/vue.min.js"></script>
    <script src="external/bootstrap_vue/bootstrap-vue.min.js"></script>
    <script src="external/jquery.min.js"></script>

    <!-- Swiper -->
    <link rel="stylesheet" href="external/swiper/swiper-bundle.css"/>
    <link rel="stylesheet" href="external/swiper/swiper-bundle.min.css"/>
    <script src="external/swiper/swiper-bundle.js"></script>
    <script src="external/swiper/swiper-bundle.min.js"></script>

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="57x57" href="./images/icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="./images/icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="./images/icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="./images/icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="./images/icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="./images/icons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="./images/icons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./images/icons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./images/icons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="./images/icons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./images/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="./images/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./images/icons/favicon-16x16.png">
    <link rel="manifest" href="./images/icons/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="./images/icons/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

  </head>

  <!-- Body -->
  <body>
    <div id="app">
      <template>

        <!-- Navbar  -->
        <header>
          <navbar-xpn></navbar-xpn>
        </header>


        <div class="contenedor row" style="margin-top: 10vh; text-align: center; margin-bottom: 7vh">
          <div class="col-lg-12 col-sm-12 row p-0 m-0">
            <div class="col-lg-2 col-sm-1 p-0"></div>

            <div class="col-lg-8 col-sm-10">
              
              <div class="col-lg-12 col-sm-12" style="text-align: center;" id="command_line">
                <h4><b>Running EXPAND</b></h4>
                <hr>

                <p align="justify">The Expand File System is based on the client-server paradigm. We need to run the server first, then run the client(s).</p>

                <h5><b>1. Running Expand mpiServer</b></h5>

                <ul>
                  <b-media tag="li" style="text-align: left;">(1) If the MPICH hydra nameserver is not running in the current host, please execute:</b-media>
                  <br>

                  <ul>
                    <b-media tag="li" class="mb-2">                        
                      <b-card-group deck>
                         <b-card>
                          <b-row no-gutters>
                            <b-col md="12">
                               <b-card-text style="text-align: left ;margin:2%;">
                                <ol>
                                  <li><code>HYDRA_HOSTNAME=$(hostname)</code></li>
                                  <li><code>[<mpich_path>/bin/]hydra_nameserver &</code></li>
                                  <li><code>sleep 1</code></li>
                                </ol>
                               </b-card-text>
                            </b-col>
                          </b-row>
                         </b-card>
                      </b-card-group>
                    </b-media>
                  </ul>

                  <b-media tag="li" style="text-align: left;">If you install MPICH with the <code>--prefix</code> switch then you need to use the <code>&lt;mpich_path&gt;/bin/</code>, otherwise it is not needed.</b-media>
                  <br>

                </ul>

                <ul>
                  <b-media tag="li" style="text-align: left;">(2) List the machines to be used in the <code>&lt;hostfile_server&gt;</code> file.</b-media>
                  <br>
                </ul>

                <ul>
                  <b-media tag="li" style="text-align: left;">(3) Start the mpiServer (with N processes distributed on the machines listed in the <code>&lt;hostfile_server&gt;</code> file) by running:</b-media>
                  <br>

                  <ul>
                    <b-media tag="li" class="mb-2">                        
                      <b-card-group deck>
                         <b-card>
                          <b-row no-gutters>
                            <b-col md="12">
                               <b-card-text style="text-align: left;margin:2%;">
                                <code>[&lt;hostfile_server&gt;/bin/]mpiexec -hostfile &lt;hostfile_server&gt; -np &lt;N&gt; -nameserver ${HYDRA_HOSTNAME} &lt;xpn_path&gt;/external-utils/mpiServer/mpiServer.exe</code>
                               </b-card-text>
                            </b-col>
                          </b-row>
                         </b-card>
                      </b-card-group>
                    </b-media>
                  </ul>
                  <br>
                  
                </ul>



                <h5><b>2. Create Configuration File</b></h5>

                <ul>
                  <b-media tag="li" style="text-align: left;">One example of configuration file for the mpiServer module of Expand Client is:</b-media>
                  <br>

                  <ul>
                    <b-media tag="li" class="mb-2">                        
                      <b-card-group deck>
                         <b-card>
                          <b-row no-gutters>
                            <b-col md="12">
                               <b-card-text style="text-align: left;margin:2%;">
                                <code>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</code>
                                <br>
                                <code>&lt;xpn_conf&gt;</code>
                                <br>
                                <code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;partition name="expand1" type="NORMAL" bsize="512k"  &gt;</code>
                                <br>
                                <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;data_node id="dn1" url="mpiServer://hostname_1/mnt/xpn"/&gt;</code>
                                <br>
                                <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;data_node id="dn2" url="mpiServer://hostname_2/mnt/xpn"/&gt;</code>
                                <br>
                                <code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/partition&gt;</code>
                                <br>
                                <code>&lt;/xpn_conf&gt;</code>
                               </b-card-text>
                            </b-col>
                          </b-row>
                         </b-card>
                      </b-card-group>
                    </b-media>
                  </ul>

                  <b-media tag="li" style="text-align: justify;">Where the label partition enables the definition of the structure of a storage partition. For each partition, we define each one of the servers used to form the partition. The servers are defined by a URL which is unique within a partition, not being able to use the same URL more than once per partition. The current prototype only allows the definition of one only partition.</b-media>
                  <br>

                  <b-media tag="li" style="text-align: justify;">Using this configuration file, the name used for a file in Expand is, for example:</b-media>
                  <br>
                  <b-media tag="li" style="text-align: justify;"><code>&nbsp;&nbsp;&nbsp;&nbsp;xpn://expand1/dirA/filename</code></b-media>
                  <br>

                  <b-media tag="li" style="text-align: justify;">We use URI for naming. This file is distributed in the partition using two servers: <code>hostname_1</code> and <code>hostname_2</code>. In each server the subfile used for this Expand file is:</b-media>
                  <br>
                  <b-media tag="li" style="text-align: justify;"><code>&nbsp;&nbsp;&nbsp;&nbsp;/mnt/xpn/dirA/filename</code></b-media>
                  <br>

                  <b-media tag="li" style="text-align: justify;">In the Expand configuration file, the type label identifies the type of file:</b-media>
                  <ul class="ml-4">
                    <li align="justify">NORMAL: a normal partition with ciclyc layout.</li>
                    <li align="justify">FT: a partition with fault tolerant support.</li>
                  </ul>
                  <br>

                </ul>



                <h5><b>3. Running Expand Client</b></h5>

                <ul>
                  <b-media tag="li" style="text-align: left;"> (1) Create the configuration file for the Expand Client where you specify the mpiServer nodes (<code>mpiServer://&gt;server&gt;/&gt;path&gt;</code>).</b-media>
                  <br>
                </ul>

                <ul>
                  <b-media tag="li" style="text-align: left;">(2.a) Run the existing client binary (with M processes distributed on the machines in the <code>&lt;hostfile_client&gt;</code> file) by using:</b-media>
                  <br>

                  <ul>
                    <b-media tag="li" class="mb-2">                        
                      <b-card-group deck>
                         <b-card>
                          <b-row no-gutters>
                            <b-col md="12">
                               <b-card-text style="text-align: left;margin:2%;">
                                <code>[&lt;mpich_path&gt;/bin/]mpiexec -hostfile &lt;hostfile_client&gt; -np &lt;M&gt; -nameserver ${HYDRA_HOSTNAME} -genv LD_PRELOAD=&lt;xpn_path&gt;/bypass/xpn_bypass.so &lt;client_binary&gt;</code>
                               </b-card-text>
                            </b-col>
                          </b-row>
                         </b-card>
                      </b-card-group>
                    </b-media>
                  </ul>
                </ul>

                <ul>
                  <b-media tag="li" style="text-align: left;">(2.b) If the client binary use the Expand API then you can execute (without intercepting the POSIX system calls) by running:</b-media>
                  <br>

                  <ul>
                    <b-media tag="li" class="mb-2">                        
                      <b-card-group deck>
                         <b-card>
                          <b-row no-gutters>
                            <b-col md="12">
                               <b-card-text style="text-align: left;margin:2%;">
                                <code>[&lt;mpich_path&gt;/bin/]mpiexec -hostfile &lt;hostfile_client&gt; -np &lt;M&gt; -nameserver ${HYDRA_HOSTNAME} &lt;client_binary&gt;</code>
                               </b-card-text>
                            </b-col>
                          </b-row>
                         </b-card>
                      </b-card-group>
                    </b-media>
                  </ul>
                </ul>

              </div>

            </div>
            <div class="col-lg-2 col-sm-1 p-0"></div>
          </div>
        </div>

      </template>
    </div>

    <!-- Required scripts -->
    <script>
      document.write("<script src=\"js/min.xpn_web.js?id=" + new Date().getTime() + "\"><\/script>");
    </script>
  </body>
</html>
